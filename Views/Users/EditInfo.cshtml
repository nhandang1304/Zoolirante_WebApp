@model Zoolirante_Open_Minded.Controllers.UsersController.ProfileEditVm
@{
    ViewData["Title"] = "Edit profile";
    string initials = (
        (Model.FirstName ?? "").FirstOrDefault() != default(char) ? char.ToUpper((Model.FirstName ?? "").First()) : ' '
    ).ToString();

    // Fallback when both First/Last empty
    if (string.IsNullOrWhiteSpace(initials) && !string.IsNullOrWhiteSpace(Model.Email))
        initials = char.ToUpper(Model.Email.First()).ToString();
}

<div class="container my-4">
    <div class="card border-0 shadow-sm">
        <div class="card-body p-4">
            <div class="d-flex align-items-center gap-3 mb-4">
                <div class="avatar-badge" aria-hidden="true">@initials</div>
                <div>
                    <h3 class="mb-0">Update your details</h3>
                    <div class="text-muted">Keep your contact info up to date for tickets, notifications and membership.</div>
                </div>
            </div>

            <form asp-action="EditInfo" method="post" class="row g-3">
                <input type="hidden" asp-for="UserId" />

                <div class="col-md-4 form-floating">
                    <input asp-for="FirstName" class="form-control" placeholder="First name" />
                    <label asp-for="FirstName">First name</label>
                    <span asp-validation-for="FirstName" class="text-danger"></span>
                </div>

                <div class="col-md-4 form-floating">
                    <input asp-for="MiddleName" class="form-control" placeholder="Middle name (optional)" />
                    <label asp-for="MiddleName">Middle name (optional)</label>
                </div>

                <div class="col-md-4 form-floating">
                    <input asp-for="LastName" class="form-control" placeholder="Last name" />
                    <label asp-for="LastName">Last name</label>
                    <span asp-validation-for="LastName" class="text-danger"></span>
                </div>

                <div class="col-md-6">
                    <label class="form-label">Best contact phone</label>
                    <div class="input-group">
                        <span class="input-group-text">📞</span>
                        <input asp-for="Phone" class="form-control" placeholder="e.g. 0400 123 456" />
                    </div>
                </div>

                <div class="col-md-6">
                    <label class="form-label">Street No.</label>
                    <div class="input-group">
                        <span class="input-group-text">🏠</span>
                        <input asp-for="Street" class="form-control" placeholder="e.g. 123 Rundle St" />
                    </div>
                </div>

                <div class="col-12">
                    <div class="alert alert-warning d-flex align-items-center" role="alert">
                        <div class="me-2">ℹ️</div>
                        <div>Your email (<strong>@Model.Email</strong>) and role (<strong>@Model.Role</strong>) are shown here but edited elsewhere for security.</div>
                    </div>
                </div>

                <div class="d-flex justify-content-between mt-2">
                    <a asp-action="Details" asp-route-id="@Model.UserId" class="btn btn-outline-secondary">Cancel</a>
                    <button type="submit" class="btn btn-primary px-4">Save changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

